# Questions OS - Concepts C2/Agent

## Fondamentaux OS
- comment l'os fonctionne 
- comment on gere les process
- comment on gere les pid
- comment on gere les threads
- comment on gere les sockets
- comment on gere les fichiers
- comment etre greffer a l'os

## Mémoire
- comment fonctionne la mémoire virtuelle vs physique
- c'est quoi le heap et le stack
- comment allouer de la mémoire (VirtualAlloc, mmap)
- comment fonctionne la protection mémoire (RWX)
- c'est quoi le memory mapping

## Syscalls & APIs
- c'est quoi un syscall vs une API Windows
- comment fonctionnent les appels syscall direct
- c'est quoi ntdll et pourquoi c'est important
- comment les AV/EDR hookent les APIs
- comment bypass les hooks (syscalls indirects)

## Injection & Exécution
- comment injecter du code dans un autre process
- c'est quoi le shellcode et comment l'exécuter
- comment fonctionne CreateRemoteThread
- c'est quoi le process hollowing
- comment fonctionne le DLL injection
- c'est quoi le reflective loading

## Évasion & Anti-Debug
- comment détecter un debugger
- comment détecter une sandbox/VM
- comment obfusquer les strings
- comment chiffrer en mémoire pendant le sleep
- c'est quoi le PEB et comment le manipuler

## Réseau bas niveau
- comment fonctionnent les sockets raw
- c'est quoi TCP vs UDP au niveau OS
- comment fonctionne le DNS au niveau système
- comment capturer du trafic réseau
- comment fonctionne le proxy système

## Persistence & Privilèges
- comment fonctionnent les tokens Windows
- c'est quoi l'impersonation
- comment escalader les privilèges
- quels sont les mécanismes de persistence (registry, services, scheduled tasks)
- comment fonctionne UAC

## Communication C2
- comment structurer un protocole C2
- comment chiffrer les communications
- comment gérer le beaconing
- comment éviter la détection réseau
- comment implémenter le jitter

## ETW & Logging (Télémétrie Windows)
- c'est quoi ETW (Event Tracing for Windows)
- comment les EDR utilisent ETW pour détecter
- comment patcher/désactiver ETW
- c'est quoi AMSI et comment le bypass
- comment fonctionne le Windows Event Log
- comment effacer les logs

## Kernel & Drivers
- c'est quoi le kernel vs userland
- comment fonctionne la transition user/kernel mode
- c'est quoi un driver et comment ça interagit
- comment les AV kernel-mode fonctionnent
- c'est quoi les callbacks kernel (PsSetCreateProcessNotifyRoutine)

## Handles & Objets Windows
- c'est quoi un handle
- comment énumérer les handles d'un process
- comment dupliquer un handle
- c'est quoi l'Object Manager
- comment fonctionne le DACL/SACL

## Credentials & Authentification
- comment fonctionne LSASS
- c'est quoi les hashes NTLM
- comment fonctionne Kerberos
- c'est quoi un ticket TGT/TGS
- comment fonctionne le credential caching
- c'est quoi DPAPI

## Mouvement Latéral
- comment fonctionne PsExec
- c'est quoi WMI et comment l'utiliser
- comment fonctionne WinRM
- c'est quoi DCOM et comment l'exploiter
- comment fonctionne SMB pour l'exécution distante
- c'est quoi le pass-the-hash/pass-the-ticket

## Anti-Forensics & Traces
- quelles traces laisse un process
- comment nettoyer les prefetch/shimcache
- comment manipuler les timestamps (timestomping)
- quels artefacts en mémoire
- comment secure delete des fichiers
- comment détecter si on est analysé (live forensics)

## Compilation & Obfuscation
- comment fonctionne le PE format (exe/dll)
- c'est quoi l'IAT et comment l'obfusquer
- comment packers/crypters fonctionnent
- comment signer un binaire
- c'est quoi le code signing et comment le bypass
- comment éviter la détection statique (entropy, strings)

## Multi-plateforme
- différences Windows vs Linux pour un agent
- comment fonctionne ELF vs PE
- c'est quoi ptrace sur Linux
- comment fonctionne LD_PRELOAD
- comment persistence sur Linux (cron, systemd, bashrc)

## Cryptographie
- c'est quoi RC4 et pourquoi c'est utilisé dans les malwares
- c'est quoi AES et ses modes (CBC, GCM)
- comment fonctionne XOR pour l'obfuscation
- c'est quoi le chiffrement symétrique vs asymétrique
- comment échanger des clés de manière sécurisée
- c'est quoi le key derivation (PBKDF2, scrypt)
- comment fonctionne le hashing (MD5, SHA256)

## Composants Malware & AV Bypass
- c'est quoi un loader
- c'est quoi un dropper
- c'est quoi un stager vs stageless
- c'est quoi un packer/crypter
- c'est quoi un shellcode runner
- comment fonctionne la détection AV (signatures, heuristique, comportemental)
- comment bypass la détection statique
- comment bypass la détection dynamique
- c'est quoi le sandboxing AV
- comment les EDR fonctionnent vs les AV
- c'est quoi le callback/beacon
- comment fonctionne le staging multi-étapes